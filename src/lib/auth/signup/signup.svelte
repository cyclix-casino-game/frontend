<script>
    import { useSignupHook } from "../hook"
    import { loading } from "$lib/store/activities";
    import { url } from "$lib/store/routes";
    import { goto } from "$app/navigation";
    import Google from "../google/google.svelte";
    let username = ""
    let email = ""
    let password = ""

    $: track = !username || !email || !password || $loading

    const handleSubmit = (async()=> {
        if(!track){
           let response = await useSignupHook({username, email, password})
           if(response){
            goto("/verification")
           }
        }
    })
    
</script>

<form method="post" on:submit|preventDefault={()=> handleSubmit()}>
    <div class="css-exhu38">
    <label for="rollbit-field-4061" class="css-1vec8iw">Username<span class="css-1vr6qde"> *</span></label>
    <div>
        <div class="css-14hgewr">
            <input type="text" name="display" placeholder="Username" id="rollbit-field-4061" bind:value={username}>
        </div>
    </div>
</div>
<div class="css-exhu38">
    <label for="rollbit-field-4062" class="css-1vec8iw">Email<span class="css-1vr6qde"> *</span></label>
    <div>
        <div class="css-14hgewr">
            <input type="email" name="email" placeholder="youremail@domain.com" id="rollbit-field-4062" bind:value={email}></div>
        </div>
    </div>
    <div class="css-exhu38">
        <label for="rollbit-field-4063" class="css-1vec8iw">Password<span class="css-1vr6qde"> *</span></label>
        <div>
            <div class="css-14hgewr">
                <input type="password" name="password" placeholder="********" id="rollbit-field-4063" bind:value={password}></div>
            </div>
        </div>
        <div id="recaptcha4064">
            <div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; position: fixed; visibility: hidden; display: block; transition: right 0.3s ease 0s; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;">
                <div class="grecaptcha-logo">
                    <iframe title="reCAPTCHA" width="256" height="60" role="presentation" name="a-y3fq78fjrglu" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="https://www.google.com/recaptcha/api2/anchor?ar=1&amp;k=6LcLy4QaAAAAAJTsyzu-3Vy0vM7N1rs71trH38oG&amp;co=aHR0cHM6Ly9yb2xsYml0LmNvbTo0NDM.&amp;hl=en&amp;v=KXX4ARWFlYTftefkdODAYWZh&amp;size=invisible&amp;cb=yp1tk462btxo"></iframe>
                </div>
                <div class="grecaptcha-error"></div>
                <textarea id="g-recaptcha-response-100008" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea>
            </div>
            <iframe title="" style="display: none;"></iframe>
            </div>
            <div class="css-1nsxilh">This site is protected by reCAPTCHA and the Google <a href="https://policies.google.com/privacy" target="_blank" rel="noreferrer">Privacy Policy</a>
                 and 
                 <a href="https://policies.google.com/terms" target="_blank" rel="noreferrer">Terms of Service</a> 
                 apply.
            </div>
            <button disabled={track} class="css-u44gss button" type="submit"> {$loading ? "Loading..." : "Start playing"}</button>
        </form>

        <Google />

<style>
   
</style>